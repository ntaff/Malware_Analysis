<!-- SYSMON CONFIGURATION FILE -->
<!-- Useful for short time malware monitoring -->
<!-- Based on SwiftOnSecurity config -->
<!-- Author : @ntaff -->

<Sysmon schemaversion="4.22">
	<HashAlgorithms>md5,sha256,IMPHASH</HashAlgorithms>
	<CheckRevocation/> <!-- Check loaded drivers, log if their code-signing certificate has been revoked -->
	<EventFiltering>

	<!--SYSMON EVENT ID 1 : PROCESS CREATION [ProcessCreate]-->
	<RuleGroup name="" groupRelation="or">
		<ProcessCreate onmatch="exclude">
			<!--SECTION: Microsoft Windows-->
			<CommandLine condition="begin with"> "C:\Windows\system32\wermgr.exe" "-queuereporting_svc" </CommandLine>
			<CommandLine condition="begin with">C:\Windows\system32\DllHost.exe /Processid</CommandLine> 
			<CommandLine condition="begin with">C:\Windows\system32\wbem\wmiprvse.exe -Embedding</CommandLine> 
			<CommandLine condition="begin with">C:\Windows\system32\wbem\wmiprvse.exe -secured -Embedding</CommandLine> 
			<CommandLine condition="is">C:\Windows\system32\wermgr.exe -upload</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\SearchIndexer.exe /Embedding</CommandLine> 
			<CommandLine condition="is">C:\windows\system32\wermgr.exe -queuereporting</CommandLine> 
			<CommandLine condition="is">\??\C:\Windows\system32\autochk.exe *</CommandLine> 
			<CommandLine condition="is">\SystemRoot\System32\smss.exe</CommandLine> 
			<CommandLine condition="is">C:\Windows\System32\RuntimeBroker.exe -Embedding</CommandLine>
			<Image condition="is">C:\Program Files (x86)\Common Files\microsoft shared\ink\TabTip32.exe</Image>
			<Image condition="is">C:\Windows\System32\TokenBrokerCookies.exe</Image> 
			<Image condition="is">C:\Windows\System32\plasrv.exe</Image>
			<Image condition="is">C:\Windows\System32\wifitask.exe</Image> 
			<Image condition="is">C:\Windows\system32\CompatTelRunner.exe</Image> 
			<Image condition="is">C:\Windows\system32\PrintIsolationHost.exe</Image>
			<Image condition="is">C:\Windows\system32\SppExtComObj.Exe</Image>
			<Image condition="is">C:\Windows\system32\audiodg.exe</Image> 
			<Image condition="is">C:\Windows\system32\conhost.exe</Image> 
			<Image condition="is">C:\Windows\system32\mobsync.exe</Image> 
			<Image condition="is">C:\Windows\system32\musNotification.exe</Image> 
			<Image condition="is">C:\Windows\system32\musNotificationUx.exe</Image> 
			<Image condition="is">C:\Windows\system32\powercfg.exe</Image> 
			<Image condition="is">C:\Windows\system32\sndVol.exe</Image> 
			<Image condition="is">C:\Windows\system32\sppsvc.exe</Image> 
			<Image condition="is">C:\Windows\system32\wbem\WmiApSrv.exe</Image> 
			<IntegrityLevel condition="is">AppContainer</IntegrityLevel> 
			<ParentCommandLine condition="begin with">%%SystemRoot%%\system32\csrss.exe ObjectDirectory=\Windows</ParentCommandLine>
			<ParentCommandLine condition="is">C:\windows\system32\wermgr.exe -queuereporting</ParentCommandLine>
			<CommandLine condition="is">C:\WINDOWS\system32\devicecensus.exe UserCxt</CommandLine>
			<CommandLine condition="is">C:\Windows\System32\usocoreworker.exe -Embedding</CommandLine>
			<ParentImage condition="is">C:\Windows\system32\SearchIndexer.exe</ParentImage>
			<!--SECTION: Microsoft:Edge-->
			<CommandLine condition="begin with">"C:\Program Files (x86)\Microsoft\Edge Dev\Application\msedge.exe" --type=</CommandLine>
			<!--SECTION: Microsoft:dotNet-->
			<CommandLine condition="begin with">C:\Windows\Microsoft.NET\Framework\v4.0.30319\ngen.exe</CommandLine> 
			<CommandLine condition="begin with">C:\WINDOWS\Microsoft.NET\Framework64\v4.0.30319\Ngen.exe</CommandLine> 
			<Image condition="is">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\mscorsvw.exe</Image> 
			<Image condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\mscorsvw.exe</Image>
			<Image condition="is">C:\Windows\Microsoft.Net\Framework64\v3.0\WPF\PresentationFontCache.exe</Image> 
			<ParentCommandLine condition="contains">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\ngentask.exe</ParentCommandLine>
			<ParentImage condition="is">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\mscorsvw.exe</ParentImage> 
			<ParentImage condition="is">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\ngentask.exe</ParentImage> 
			<ParentImage condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\mscorsvw.exe</ParentImage> 
			<ParentImage condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\ngentask.exe</ParentImage> 
			<!--SECTION: Microsoft:Office-->
			<Image condition="is">C:\Program Files\Microsoft Office\Office16\MSOSYNC.EXE</Image> 
			<Image condition="is">C:\Program Files (x86)\Microsoft Office\Office16\MSOSYNC.EXE</Image> 
			<Image condition="is">C:\Program Files\Common Files\Microsoft Shared\OfficeSoftwareProtectionPlatform\OSPPSVC.EXE</Image> 
			<Image condition="is">C:\Program Files\Microsoft Office\Office16\msoia.exe</Image> 
			<Image condition="is">C:\Program Files (x86)\Microsoft Office\root\Office16\officebackgroundtaskhandler.exe</Image>
			<!--SECTION: Microsoft:Office:Click2Run-->
			<Image condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeC2RClient.exe</Image> 
			<ParentImage condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeClickToRun.exe</ParentImage> 
			<ParentImage condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeC2RClient.exe</ParentImage> 
			<!--SECTION: Windows: Media player-->
			<Image condition="is">C:\Program Files\Windows Media Player\wmpnscfg.exe</Image> 
			<!--SECTION: Google-->
			<CommandLine condition="begin with">"C:\Program Files (x86)\Google\Chrome\Application\chrome.exe" --type=</CommandLine> 
			<CommandLine condition="begin with">"C:\Program Files\Google\Chrome\Application\chrome.exe" --type=</CommandLine> 
		</ProcessCreate>
	</RuleGroup>
	
	<!--SYSMON EVENT ID 2 : FILE CREATION TIME RETROACTIVELY CHANGED IN THE FILESYSTEM [FileCreateTime]-->
	<RuleGroup name="" groupRelation="or">
		<FileCreateTime onmatch="include">
			<Image name="T1099" condition="begin with">C:\Users</Image> 
			<TargetFilename name="T1099" condition="end with">.exe</TargetFilename>
			<Image name="T1099" condition="begin with">\Device\HarddiskVolumeShadowCopy</Image>
		</FileCreateTime>
	</RuleGroup>

	<!--SYSMON EVENT ID 3 : NETWORK CONNECTION INITIATED [NetworkConnect]-->
	<RuleGroup name="" groupRelation="or">
		<NetworkConnect onmatch="include">
			<!--Suspicious sources for network-connecting binaries-->
			<Image name="Usermode" condition="begin with">C:\Users</Image> 
			<Image name="Caution" condition="begin with">C:\Recycle</Image>
			<Image condition="begin with">C:\ProgramData</Image> 
			<Image condition="begin with">C:\Windows\Temp</Image> 
			<Image name="Caution" condition="begin with">\</Image> 
			<Image name="Caution" condition="begin with">C:\perflogs</Image> 
			<Image name="Caution" condition="begin with">C:\intel</Image> 
			<Image name="Caution" condition="begin with">C:\Windows\fonts</Image> 
			<Image name="Caution" condition="begin with">C:\Windows\system32\config</Image> 
			<!--Suspicious Windows tools-->
			<Image condition="image">at.exe</Image>
			<Image condition="image">arp.exe</Image>
			<Image condition="image">certutil.exe</Image> 
			<Image condition="image">cmd.exe</Image> 
			<Image condition="image">cmstp.exe</Image> 
			<Image condition="image">cscript.exe</Image> 
			<Image condition="image">driverquery.exe</Image> 
			<Image condition="image">dsquery.exe</Image> 
			<Image condition="image">hh.exe</Image> 
			<Image condition="image">infDefaultInstall.exe</Image> 
			<Image condition="image">java.exe</Image> 
			<Image condition="image">javaw.exe</Image> 
			<Image condition="image">javaws.exe</Image> 
			<Image condition="image">mmc.exe</Image> 
			<Image condition="image">msbuild.exe</Image> 
			<Image condition="image">mshta.exe</Image> 
			<Image condition="image">msiexec.exe</Image>
			<Image condition="image">nbtstat.exe</Image>
			<Image condition="image">net.exe</Image>
			<Image condition="image">net1.exe</Image> 
			<Image condition="image">notepad.exe</Image> 
			<Image condition="image">nslookup.exe</Image> 
			<Image condition="image">powershell.exe</Image>
			<Image condition="image">powershell_ise.exe</Image>
			<Image condition="image">qprocess.exe</Image> 
			<Image condition="image">qwinsta.exe</Image> 
			<Image condition="image">qwinsta.exe</Image> 
			<Image condition="image">reg.exe</Image>
			<Image condition="image">regsvcs.exe</Image> 
			<Image condition="image">regsvr32.exe</Image>
			<Image condition="image">rundll32.exe</Image>
			<Image condition="image">rwinsta.exe</Image> 
			<Image condition="image">sc.exe</Image>
			<Image condition="image">schtasks.exe</Image>
			<Image condition="image">taskkill.exe</Image>
			<Image condition="image">tasklist.exe</Image>
			<Image condition="image">wmic.exe</Image>
			<Image condition="image">wscript.exe</Image> 
			<Image condition="image">bitsadmin.exe</Image>
			<Image condition="image">esentutl.exe</Image>
			<Image condition="image">expand.exe</Image>
			<Image condition="image">extrac32.exe</Image>
			<Image condition="image">findstr.exe</Image> 
			<Image condition="image">GfxDownloadWrapper.exe</Image> 
			<Image condition="image">ieexec.exe</Image>
			<Image condition="image">makecab.exe</Image> 
			<Image condition="image">replace.exe</Image> 
			<Image condition="image">Excel.exe</Image> 
			<Image condition="image">Powerpnt.exe</Image> 
			<Image condition="image">Winword.exe</Image>
			<Image condition="image">squirrel.exe</Image>
			<Image condition="image">pwsh.exe</Image>
			<Image condition="image">wusa.exe</Image>
			<Image condition="image">WSReset.exe</Image>
			<Image condition="image">winsat.exe</Image>
			<Image condition="image">tzsync.exe</Image>
			<Image condition="image">TpmInit.exe</Image>
			<Image condition="image">taskhost.exe</Image>
			<Image condition="image">slui.exe</Image>
			<Image condition="image">sysprep.exe</Image>
			<!--Relevant 3rd Party Tools-->
			<Image condition="image">nc.exe</Image>
			<Image condition="image">ncat.exe</Image> 
			<Image condition="image">psexec.exe</Image>
			<Image condition="image">psexesvc.exe</Image> 
			<Image condition="image">tor.exe</Image>
			<Image condition="image">vnc.exe</Image> 
			<Image condition="image">vncservice.exe</Image> 
			<Image condition="image">vncviewer.exe</Image> 
			<Image condition="image">winexesvc.exe</Image> 
			<Image condition="image">nmap.exe</Image>
			<Image condition="image">psinfo.exe</Image>
			<!--Ports: Suspicious-->
			<DestinationPort name="SSH" condition="is">22</DestinationPort> 
			<DestinationPort name="Telnet" condition="is">23</DestinationPort> 
			<DestinationPort name="SMTP" condition="is">25</DestinationPort> 
			<DestinationPort name="IMAP" condition="is">143</DestinationPort> 
			<DestinationPort name="RDP" condition="is">3389</DestinationPort> 
			<DestinationPort name="VNC" condition="is">5800</DestinationPort> 
			<DestinationPort name="VNC" condition="is">5900</DestinationPort> 
			<DestinationPort name="Alert,Metasploit" condition="is">444</DestinationPort>
			<!--Tor-->
			<DestinationPort name="Tor" condition="is">1723</DestinationPort>
			<DestinationPort name="Tor" condition="is">9001</DestinationPort> 
			<DestinationPort name="Tor" condition="is">9030</DestinationPort> 
			<!--Proxy-->
			<DestinationPort name="Proxy" condition="is">1080</DestinationPort>
			<DestinationPort name="Proxy" condition="is">3128</DestinationPort> 
			<DestinationPort name="Proxy" condition="is">8080</DestinationPort> 
		</NetworkConnect>
	</RuleGroup>

	<RuleGroup name="" groupRelation="or">
		<NetworkConnect onmatch="exclude">
			<!--Loopback Addresses-->
			<DestinationIp condition="is">127.0.0.1</DestinationIp>
			<DestinationIp condition="begin with">fe80:0:0:0</DestinationIp> 
		</NetworkConnect>
	</RuleGroup>



	<!--SYSMON EVENT ID 5 : PROCESS ENDED [ProcessTerminate]-->
	<RuleGroup name="" groupRelation="or">
		<ProcessTerminate onmatch="include">
			<Image condition="begin with">C:\Users</Image> 
			<Image condition="begin with">\</Image>
		</ProcessTerminate>
	</RuleGroup>

	<RuleGroup name="" groupRelation="or">
		<ProcessTerminate onmatch="exclude">
		</ProcessTerminate>
	</RuleGroup>

	<!--SYSMON EVENT ID 6 : DRIVER LOADED INTO KERNEL [DriverLoad]-->
	<RuleGroup name="" groupRelation="or">
		<DriverLoad onmatch="exclude">
			<!--Exclude signed drivers-->
			<Rule groupRelation="and">
				<Signature condition="contains">Microsoft</Signature>
				<SignatureStatus condition="is">Valid</SignatureStatus>
			</Rule>
			<Rule groupRelation="and">
				<Signature condition="contains">Windows</Signature>
				<SignatureStatus condition="is">Valid</SignatureStatus>
			</Rule>
			<Rule groupRelation="and">
				<Signature condition="contains">Intel</Signature>
				<SignatureStatus condition="is">Valid</SignatureStatus>
			</Rule>
			<Rule groupRelation="and">
				<Signature condition="contains">VMware</Signature>
				<SignatureStatus condition="is">Valid</SignatureStatus>
			</Rule>
			<Rule groupRelation="and">
				<Signature condition="contains">Virtualbox</Signature>
				<SignatureStatus condition="is">Valid</SignatureStatus>
			</Rule>
		</DriverLoad>
	</RuleGroup>

	<!--SYSMON EVENT ID 7 : DLL (IMAGE) LOADED BY PROCESS [ImageLoad]-->
	<RuleGroup name="" groupRelation="or">
		<ImageLoad onmatch="include">
			<!--DISABLE-->
		</ImageLoad>
	</RuleGroup>

	<!--SYSMON EVENT ID 8 : REMOTE THREAD CREATED [CreateRemoteThread]-->
	<RuleGroup name="" groupRelation="or">
		<CreateRemoteThread onmatch="exclude">
			<!--COMMENT: Exclude mostly-safe sources and log anything else.-->
			<SourceImage condition="is">C:\Windows\system32\wbem\WmiPrvSE.exe</SourceImage>
			<SourceImage condition="is">C:\Windows\system32\svchost.exe</SourceImage>
			<SourceImage condition="is">C:\Windows\system32\wininit.exe</SourceImage>
			<SourceImage condition="is">C:\Windows\system32\csrss.exe</SourceImage>
			<SourceImage condition="is">C:\Windows\system32\services.exe</SourceImage>
			<SourceImage condition="is">C:\Windows\system32\winlogon.exe</SourceImage>
			<SourceImage condition="is">C:\Windows\system32\audiodg.exe</SourceImage>
			<StartModule condition="is">C:\Windows\system32\kernel32.dll</StartModule>
			<TargetImage condition="is">C:\Program Files (x86)\Google\Chrome\Application\chrome.exe</TargetImage>
		</CreateRemoteThread>
	</RuleGroup>

	<!--SYSMON EVENT ID 9 : RAW DISK ACCESS [RawAccessRead]-->
	<RuleGroup name="" groupRelation="or">
		<RawAccessRead onmatch="include">
			<!--DISABLE-->
		</RawAccessRead>
	</RuleGroup>

	<!--SYSMON EVENT ID 10 : INTER-PROCESS ACCESS [ProcessAccess]-->
	<RuleGroup name="" groupRelation="or">
		<ProcessAccess onmatch="include">
			<!--DISABLE-->
		</ProcessAccess>
	</RuleGroup>

	<!--SYSMON EVENT ID 11 : FILE CREATED [FileCreate]-->
	<RuleGroup name="" groupRelation="or">
		<FileCreate onmatch="include">
			<TargetFilename name="T1023" condition="contains">\Start Menu</TargetFilename> 
			<TargetFilename name="T1165" condition="contains">\Startup\</TargetFilename> 
			<TargetFilename name="OutlookAttachment" condition="contains">\Content.Outlook\</TargetFilename>
			<TargetFilename name="Downloads" condition="contains">\Downloads\</TargetFilename> 
			<TargetFilename condition="end with">.application</TargetFilename> 
			<TargetFilename condition="end with">.appref-ms</TargetFilename> 
			<TargetFilename condition="end with">.bat</TargetFilename> 
			<TargetFilename condition="end with">.chm</TargetFilename>
			<TargetFilename condition="end with">.cmd</TargetFilename> 
			<TargetFilename condition="end with">.cmdline</TargetFilename> 
			<TargetFilename name="T1176" condition="end with">.crx</TargetFilename> 
			<TargetFilename condition="end with">.dmp</TargetFilename> 
			<TargetFilename condition="end with">.docm</TargetFilename> 
			<TargetFilename name="DLL" condition="end with">.dll</TargetFilename> 
			<TargetFilename name="EXE" condition="end with">.exe</TargetFilename>
			<TargetFilename name="ProcessHostingdotNETCode" condition="end with">.exe.log</TargetFilename>
			<TargetFilename condition="end with">.jar</TargetFilename>
			<TargetFilename condition="end with">.jnlp</TargetFilename>
			<TargetFilename condition="end with">.jse</TargetFilename> 
			<TargetFilename condition="end with">.hta</TargetFilename> 
			<TargetFilename condition="end with">.job</TargetFilename> 
			<TargetFilename condition="end with">.pptm</TargetFilename>
			<TargetFilename condition="end with">.ps1</TargetFilename> 
			<TargetFilename condition="end with">.sys</TargetFilename>
			<TargetFilename condition="end with">.scr</TargetFilename> 
			<TargetFilename condition="end with">.vbe</TargetFilename> 
			<TargetFilename condition="end with">.vbs</TargetFilename> 
			<TargetFilename condition="end with">.xlsm</TargetFilename> 
			<TargetFilename condition="end with">proj</TargetFilename>
			<TargetFilename condition="end with">.sln</TargetFilename>
			<TargetFilename condition="end with">.sct</TargetFilename> 
			<TargetFilename condition="end with">.wsf</TargetFilename> 
			<TargetFilename condition="end with">.wsh</TargetFilename> 
			<TargetFilename condition="begin with">C:\</TargetFilename> 
			<TargetFilename name="T1037,T1484" condition="begin with">C:\Windows\system32\GroupPolicy\Machine\Scripts</TargetFilename> 
			<TargetFilename name="T1037,T1484" condition="begin with">C:\Windows\system32\GroupPolicy\User\Scripts</TargetFilename> 
			<Image condition="begin with">\Device\HarddiskVolumeShadowCopy</Image> 
			<!--Exploitable file names-->
			<TargetFilename condition="end with">.xls</TargetFilename> 
			<TargetFilename condition="end with">.ppt</TargetFilename> 
			<TargetFilename condition="end with">.rtf</TargetFilename>
		</FileCreate>
	</RuleGroup>

	<RuleGroup name="" groupRelation="or">
		<FileCreate onmatch="exclude">
			<!--SECTION: Microsoft-->
			<Image condition="is">C:\Program Files (x86)\EMET 5.5\EMET_Service.exe</Image> 
			<!--SECTION: Microsoft:Office:Click2Run-->
			<Image condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeC2RClient.exe</Image> 
			<!--SECTION: Windows-->
			<Image condition="is">C:\Windows\system32\smss.exe</Image>
			<Image condition="is">C:\Windows\system32\CompatTelRunner.exe</Image>
			<Image condition="is">\\?\C:\Windows\system32\wbem\WMIADAP.EXE</Image> 
			<Image condition="is">C:\Windows\system32\mobsync.exe</Image> 
			<TargetFilename condition="begin with">C:\Windows\system32\DriverStore\Temp\</TargetFilename> 
			<TargetFilename condition="begin with">C:\Windows\system32\wbem\Performance\</TargetFilename> 
			<TargetFilename condition="begin with">C:\Windows\Installer\</TargetFilename> 
			<!--SECTION: Windows:Updates-->
			<TargetFilename condition="begin with">C:\$WINDOWS.~BT\Sources\</TargetFilename> 
			<Image condition="begin with">C:\Windows\winsxs\amd64_microsoft-windows</Image> 
		</FileCreate>
	</RuleGroup>

	<!--SYSMON EVENT ID 12 & 13 & 14 : REGISTRY MODIFICATION [RegistryEvent]-->
	<RuleGroup name="" groupRelation="or">
		<RegistryEvent onmatch="include">
			<!--Autorun or Startups-->
			<TargetObject name="T1060,RunKey" condition="contains">CurrentVersion\Run</TargetObject> 
			<TargetObject name="T1060,RunKey" condition="contains">PendingFileRenameOperations</TargetObject> 
			<TargetObject name="T1060,RunPolicy" condition="contains">Policies\Explorer\Run</TargetObject>
			<TargetObject name="T1484" condition="contains">Group Policy\Scripts</TargetObject>
			<TargetObject name="T1484" condition="contains">Windows\System\Scripts</TargetObject>
			<TargetObject name="T1060" condition="contains">CurrentVersion\Windows\Load</TargetObject>
			<TargetObject name="T1060" condition="contains">CurrentVersion\Windows\Run</TargetObject>
			<TargetObject name="T1060" condition="contains">CurrentVersion\Winlogon\Shell</TargetObject> 
			<TargetObject name="T1060" condition="contains">CurrentVersion\Winlogon\System</TargetObject> 
			<TargetObject condition="begin with">HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify</TargetObject>
			<TargetObject condition="begin with">HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell</TargetObject>
			<TargetObject condition="begin with">HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit</TargetObject> 
			<TargetObject condition="begin with">HKLM\Software\WOW6432Node\Microsoft\Windows NT\CurrentVersion\Drivers32</TargetObject> 
			<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\BootExecute</TargetObject> 
			<TargetObject condition="begin with">HKLM\Software\Microsoft\Windows NT\CurrentVersion\AeDebug</TargetObject> 
			<TargetObject condition="contains">UserInitMprLogonScript</TargetObject> 
			<TargetObject name="T1112,ChangeStartupFolderPath" condition="end with">user shell folders\startup</TargetObject> 
			<!--Services-->
			<TargetObject name="T1031,T1050" condition="end with">\ServiceDll</TargetObject>
			<TargetObject name="T1031,T1050" condition="end with">\ServiceManifest</TargetObject> 
			<TargetObject name="T1031,T1050" condition="end with">\ImagePath</TargetObject>
			<TargetObject name="T1031,T1050" condition="end with">\Start</TargetObject> 
			<!--RDP-->
			<TargetObject name="RDP port change" condition="end with">Control\Terminal Server\WinStations\RDP-Tcp\PortNumber</TargetObject> 
			<TargetObject name="RDP port change" condition="end with">Control\Terminal Server\fSingleSessionPerUser</TargetObject> 
			<TargetObject name="ModifyRemoteDesktopState" condition="end with">fDenyTSConnections</TargetObject> 
			<TargetObject condition="end with">LastLoggedOnUser</TargetObject> 
			<TargetObject name="ModifyRemoteDesktopPort" condition="end with">RDP-tcp\PortNumber</TargetObject> 
			<TargetObject condition="end with">Services\PortProxy\v4tov4</TargetObject> 
			<!--CLSID launch commands and Default File Association changes-->
			<TargetObject name="T1042" condition="contains">\command\</TargetObject> 
			<TargetObject name="T1122" condition="contains">\ddeexec\</TargetObject> 
			<TargetObject name="T1122" condition="contains">{86C86720-42A0-1069-A2E8-08002B30309D}</TargetObject> 
			<TargetObject name="T1042" condition="contains">exefile</TargetObject> 
			<!--Windows COM-->
			<TargetObject name="T1122" condition="end with">\InprocServer32\(Default)</TargetObject> 
			<!--Windows shell visual modifications used by malware-->
			<TargetObject name="T1158" condition="end with">\Hidden</TargetObject> 
			<TargetObject name="T1158" condition="end with">\ShowSuperHidden</TargetObject> 
			<TargetObject name="T1158" condition="end with">\HideFileExt</TargetObject> 
			<!--Windows shell hijack and modifications-->
			<TargetObject condition="contains">Classes\*\</TargetObject>
			<TargetObject condition="contains">Classes\AllFilesystemObjects\</TargetObject> 
			<TargetObject condition="contains">Classes\Directory\</TargetObject> 
			<TargetObject condition="contains">Classes\Drive\</TargetObject> 
			<TargetObject condition="contains">Classes\Folder\</TargetObject> 
			<TargetObject condition="contains">Classes\PROTOCOLS\</TargetObject> 
			<TargetObject condition="contains">ContextMenuHandlers\</TargetObject> 
			<TargetObject condition="contains">CurrentVersion\Shell</TargetObject> 
			<TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\explorer\ShellExecuteHooks</TargetObject> 
			<TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\explorer\ShellServiceObjectDelayLoad</TargetObject> 
			<TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\explorer\ShellIconOverlayIdentifiers</TargetObject> 
			<!--AppPaths hijacking-->
			<TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\App Paths\</TargetObject> 
			<!--Terminal service boobytrap-->
			<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp\InitialProgram</TargetObject> 
			<!--Group Policy integrity-->
			<TargetObject name="T1484" condition="begin with">HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions\</TargetObject> 
			<!--Winsock and Winsock2-->
			<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\WinSock</TargetObject> 
			<TargetObject condition="end with">\ProxyServer</TargetObject> 
			<!--Credential providers-->
			<TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Authentication\Credential Provider</TargetObject> 
			<TargetObject name="T1101" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\</TargetObject> 
			<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SecurityProviders</TargetObject> 
			<TargetObject condition="begin with">HKLM\Software\Microsoft\Netsh</TargetObject> 
			<!--Networking-->
			<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\NetworkProvider\Order\</TargetObject> 
			<TargetObject condition="begin with">HKLM\Software\Microsoft\Windows NT\CurrentVersion\NetworkList\Profiles</TargetObject> 
			<TargetObject name="T1089" condition="end with">\EnableFirewall</TargetObject> 
			<TargetObject name="T1089" condition="end with">\DoNotAllowExceptions</TargetObject>
			<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\StandardProfile\AuthorizedApplications\List</TargetObject> 
			<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\DomainProfile\AuthorizedApplications\List</TargetObject> 
			<!--DLLs that get injected into every process at launch-->
			<TargetObject name="T1103" condition="begin with">HKLM\Software\Microsoft\Windows NT\CurrentVersion\Windows\Appinit_Dlls\</TargetObject>
			<TargetObject name="T1103" condition="begin with">HKLM\Software\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Windows\Appinit_Dlls\</TargetObject> 
			<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\AppCertDlls\</TargetObject> 
			<!--Office-->
			<TargetObject name="T1137" condition="contains">Microsoft\Office\Outlook\Addins\</TargetObject>
			<TargetObject name="T1137" condition="contains">Office Test\</TargetObject> 
			<TargetObject name="Context,ProtectedModeExitOrMacrosUsed" condition="contains">Security\Trusted Documents\TrustRecords</TargetObject> 
			<!--IE-->
			<TargetObject name="T1176" condition="contains">Internet Explorer\Toolbar\</TargetObject> 
			<TargetObject name="T1176" condition="contains">Internet Explorer\Extensions\</TargetObject> 
			<TargetObject name="T1176" condition="contains">Browser Helper Objects\</TargetObject> 
			<TargetObject condition="end with">\DisableSecuritySettingsCheck</TargetObject>
			<TargetObject condition="end with">\3\1206</TargetObject> 
			<TargetObject condition="end with">\3\2500</TargetObject> 
			<TargetObject condition="end with">\3\1809</TargetObject> 
			<!--Magic registry keys-->
			<TargetObject condition="begin with">HKLM\Software\Classes\CLSID\{AB8902B4-09CA-4BB6-B78D-A8F59079A8D5}\</TargetObject> 
			<TargetObject condition="begin with">HKLM\Software\Classes\WOW6432Node\CLSID\{AB8902B4-09CA-4BB6-B78D-A8F59079A8D5}\</TargetObject> 
			<TargetObject condition="begin with">HKLM\Software\Classes\CLSID\{083863F1-70DE-11d0-BD40-00A0C911CE86}\</TargetObject>
			<TargetObject condition="begin with">HKLM\Software\Classes\WOW6432Node\CLSID\{083863F1-70DE-11d0-BD40-00A0C911CE86}\</TargetObject>
			<!--Install/Run artifacts-->
			<TargetObject condition="end with">\UrlUpdateInfo</TargetObject> 
			<TargetObject condition="end with">\InstallSource</TargetObject> 
			<TargetObject name="Alert,Sysinternals Tool Used" condition="end with">\EulaAccepted</TargetObject> 
			<!--Antivirus tampering-->
			<TargetObject name="T1089,Tamper-Defender" condition="end with">\DisableAntiSpyware</TargetObject> 
			<TargetObject name="T1089,Tamper-Defender" condition="end with">\DisableAntiVirus</TargetObject> 
			<TargetObject name="T1089,Tamper-Defender" condition="end with">\SpynetReporting</TargetObject> 
			<TargetObject name="T1089,Tamper-Defender" condition="end with">DisableRealtimeMonitoring</TargetObject> 
			<TargetObject name="T1089,Tamper-Defender" condition="end with">\SubmitSamplesConsent</TargetObject> 
			<!--Windows UAC tampering-->
			<TargetObject name="T1088" condition="end with">HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\EnableLUA</TargetObject> 
			<TargetObject name="T1088" condition="end with">HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\LocalAccountTokenFilterPolicy</TargetObject> 
			<!--Microsoft Security Center tampering | Credit @ion-storm -->
			<TargetObject name="T1089,Tamper-SecCenter" condition="end with">HKLM\Software\Microsoft\Security Center\</TargetObject> 
			<TargetObject name="T1089,Tamper-SecCenter" condition="end with">SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\HideSCAHealth</TargetObject> 
			<!--Windows application compatibility-->
			<TargetObject name="T1138,AppCompatShim" condition="begin with">HKLM\Software\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Custom</TargetObject> 
			<TargetObject name="T1138,AppCompatShim" condition="begin with">HKLM\Software\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\InstalledSDB</TargetObject> 
			<TargetObject condition="contains">VirtualStore</TargetObject> 
			<!--Windows internals integrity monitoring-->
			<TargetObject name="T1183,IFEO" condition="begin with">HKLM\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\</TargetObject> 
			<TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\WINEVT\</TargetObject> 
			<TargetObject name="Tamper-Safemode" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Safeboot\</TargetObject> 
			<TargetObject name="Tamper-Winlogon" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Winlogon\</TargetObject> 
			<TargetObject name="Context,DeviceConntectedOrUpdated" condition="end with">\FriendlyName</TargetObject> 
			<TargetObject name="Context,MsiInstallerStarted" condition="is">HKLM\Software\Microsoft\Windows\CurrentVersion\Installer\InProgress\(Default)</TargetObject> 
			<TargetObject name="Tamper-Tracing" condition="begin with">HKLM\Software\Microsoft\Tracing\RASAPI32</TargetObject>
			<!--Windows inventory events-->
			<TargetObject name="InvDB-Path" condition="end with">\LowerCaseLongPath</TargetObject> 
			<TargetObject name="InvDB-Pub" condition="end with">\Publisher</TargetObject> 
			<TargetObject name="InvDB-Ver" condition="end with">\BinProductVersion</TargetObject> 
			<TargetObject name="InvDB-DriverVer" condition="end with">\DriverVersion</TargetObject> 
			<TargetObject name="InvDB-DriverVer" condition="end with">\DriverVerVersion</TargetObject>
			<TargetObject name="InvDB-CompileTimeClaim" condition="end with">\LinkDate</TargetObject> 
			<TargetObject name="InvDB" condition="contains">Compatibility Assistant\Store\</TargetObject>
			<!--Suspicious sources-->
			<Image name="Suspicious,ImageBeginWithBackslash" condition="begin with">\</Image>
		</RegistryEvent>
	</RuleGroup>
	<!--Removing noisy and safe events-->
	<RuleGroup name="" groupRelation="or">
		<RegistryEvent onmatch="exclude">
			<TargetObject condition="contains">\{CAFEEFAC-</TargetObject>
			<EventType condition="is">CreateKey</EventType>
			<TargetObject condition="begin with">HKLM\COMPONENTS</TargetObject>
			<!--Inventory noise-->
			<TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\AppModel\StateRepository\Cache</TargetObject>
			<!--Misc-->
			<TargetObject condition="end with">Toolbar\WebBrowser</TargetObject> 
			<TargetObject condition="end with">Browser\ITBar7Height</TargetObject> 
			<TargetObject condition="end with">Browser\ITBar7Layout</TargetObject> 
			<TargetObject condition="end with">Internet Explorer\Toolbar\Locked</TargetObject> 
			<TargetObject condition="end with">Toolbar\WebBrowser\{47833539-D0C5-4125-9FA8-0819E2EAAC93}</TargetObject> 
			<TargetObject condition="end with">}\PreviousPolicyAreas</TargetObject> 
			<TargetObject condition="contains">\Control\WMI\Autologger\</TargetObject> 
			<TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Services\UsoSvc\Start</TargetObject> 
			<TargetObject condition="end with">\Lsa\OfflineJoin\CurrentValue</TargetObject> 
			<TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\</TargetObject> 
			<TargetObject condition="contains">_Classes\AppX</TargetObject>
			<TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\WINEVT\Publishers\</TargetObject> 
			<!--Bootup Control noise-->
			<TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\LsaPid</TargetObject> 
			<TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\SspiCache</TargetObject> 
			<TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Kerberos\Domains</TargetObject>
			<!--Services startup settings noise, some low-risk services routinely change it and this can be ignored-->
			<TargetObject condition="end with">\Services\BITS\Start</TargetObject> 
			<TargetObject condition="end with">\services\clr_optimization_v2.0.50727_32\Start</TargetObject> 
			<TargetObject condition="end with">\services\clr_optimization_v2.0.50727_64\Start</TargetObject> 
			<TargetObject condition="end with">\services\clr_optimization_v4.0.30319_32\Start</TargetObject> 
			<TargetObject condition="end with">\services\clr_optimization_v4.0.30319_64\Start</TargetObject> 
			<TargetObject condition="end with">\services\deviceAssociationService\Start</TargetObject> 
			<TargetObject condition="end with">\services\fhsvc\Start</TargetObject> 
			<TargetObject condition="end with">\services\nal\Start</TargetObject> 
			<TargetObject condition="end with">\services\trustedInstaller\Start</TargetObject> 
			<TargetObject condition="end with">\services\tunnel\Start</TargetObject>
			<TargetObject condition="end with">\services\usoSvc\Start</TargetObject> 
			<!--FileExts noise filtering-->
			<TargetObject condition="end with">\UserChoice\ProgId</TargetObject> 
			<TargetObject condition="end with">\UserChoice\Hash</TargetObject> 
			<TargetObject condition="end with">\OpenWithList\MRUList</TargetObject> 
			<TargetObject condition="contains">Shell Extentions\Cached</TargetObject>
			<!--Group Policy noise-->
			<TargetObject condition="end with">HKLM\System\CurrentControlSet\Control\Lsa\Audit\SpecialGroups</TargetObject> 
			<TargetObject condition="end with">SOFTWARE\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Startup\0\PSScriptOrder</TargetObject> 
			<TargetObject condition="end with">SOFTWARE\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Startup\0\SOM-ID</TargetObject> 
			<TargetObject condition="end with">SOFTWARE\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Startup\0\GPO-ID</TargetObject> 
			<TargetObject condition="end with">SOFTWARE\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Startup\0\0\IsPowershell</TargetObject> 
			<TargetObject condition="end with">SOFTWARE\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Startup\0\0\ExecTime</TargetObject> 
			<TargetObject condition="end with">SOFTWARE\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Shutdown\0\PSScriptOrder</TargetObject> 
			<TargetObject condition="end with">SOFTWARE\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Shutdown\0\SOM-ID</TargetObject> 
			<TargetObject condition="end with">SOFTWARE\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Shutdown\0\GPO-ID</TargetObject> 
			<TargetObject condition="end with">SOFTWARE\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Shutdown\0\0\IsPowershell</TargetObject> 
			<TargetObject condition="end with">SOFTWARE\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Shutdown\0\0\ExecTime</TargetObject> 
			<TargetObject condition="contains">\safer\codeidentifiers\0\HASHES\{</TargetObject>
			<!--SECTION: Office C2R-->
			<TargetObject condition="contains">VirtualStore\MACHINE\SOFTWARE\Microsoft\Office\ClickToRun\</TargetObject> 
			<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Office\ClickToRun\</TargetObject> 
			<!--SECTION: 3rd party-->
			<Image condition="is">C:\Program Files\WIDCOMM\Bluetooth Software\btwdins.exe</Image> 
			<TargetObject condition="begin with">HKCR\VLC.</TargetObject>
			<TargetObject condition="begin with">HKCR\iTunes.</TargetObject>
			<!--WINEVT publishers noise-->
			<TargetObject condition="is">HKLM\Software\Microsoft\Windows\CurrentVersion\WINEVT\Publishers\{945a8954-c147-4acd-923f-40c45405a658}</TargetObject>
		</RegistryEvent>
	</RuleGroup>

	<!--SYSMON EVENT ID 15 : ALTERNATE DATA STREAM CREATED [FileCreateStreamHash]-->
		<FileCreateStreamHash onmatch="include">
			<TargetFilename condition="contains">Downloads</TargetFilename>
			<TargetFilename condition="contains">Temp\7z</TargetFilename> 
			<TargetFilename condition="contains">Startup</TargetFilename> 
			<TargetFilename condition="end with">.bat</TargetFilename> 
			<TargetFilename condition="end with">.cmd</TargetFilename>  
			<TargetFilename condition="end with">.doc</TargetFilename> 
			<TargetFilename condition="end with">.hta</TargetFilename> 
			<TargetFilename condition="end with">.lnk</TargetFilename> 
			<TargetFilename condition="end with">.ppt</TargetFilename> 
			<TargetFilename condition="end with">.ps1</TargetFilename> 
			<TargetFilename condition="end with">.ps2</TargetFilename> 
			<TargetFilename condition="end with">.reg</TargetFilename> 
			<TargetFilename condition="end with">.jse</TargetFilename> 
			<TargetFilename condition="end with">.vb</TargetFilename>
			<TargetFilename condition="end with">.vbe</TargetFilename> 
			<TargetFilename condition="end with">.vbs</TargetFilename>
		</FileCreateStreamHash>

	<RuleGroup name="" groupRelation="or">
		<FileCreateStreamHash onmatch="exclude">
		</FileCreateStreamHash>
	</RuleGroup>

	<!--SYSMON EVENT ID 16 : SYSMON CONFIGURATION CHANGE-->
		<!--Cannot be filtered.-->

	<!--SYSMON EVENT ID 17 & 18 : PIPE CREATED / PIPE CONNECTED [PipeEvent]-->
	<RuleGroup name="" groupRelation="or">
		<PipeEvent onmatch="include">
			<!--DISABLE-->
		</PipeEvent>
	</RuleGroup>

	<!--SYSMON EVENT ID 19 & 20 & 21 : WMI EVENT MONITORING [WmiEvent]-->

	<RuleGroup name="" groupRelation="or">
		<WmiEvent onmatch="exclude">
			<!--DISABLE-->
		</WmiEvent>
	</RuleGroup>

	<!--SYSMON EVENT ID 22 : DNS QUERY [DnsQuery]-->
	<RuleGroup name="" groupRelation="or">
		<DnsQuery onmatch="exclude">
			<!--Network noise-->
			<QueryName condition="end with">.arpa.</QueryName> 
			<QueryName condition="end with">.arpa</QueryName> 
			<QueryName condition="end with">.msftncsi.com</QueryName>
			<QueryName condition="is">..localmachine</QueryName>
			<QueryName condition="is">localhost</QueryName>
			<!--Microsoft-->
			<QueryName condition="end with">-pushp.svc.ms</QueryName> 
			<QueryName condition="end with">.b-msedge.net</QueryName>
			<QueryName condition="end with">.bing.com</QueryName> 
			<QueryName condition="end with">.hotmail.com</QueryName> 
			<QueryName condition="end with">.live.com</QueryName> 
			<QueryName condition="end with">.live.net</QueryName> 
			<QueryName condition="end with">.s-microsoft.com</QueryName>
			<QueryName condition="end with">.microsoft.com</QueryName> 
			<QueryName condition="end with">.microsoftonline.com</QueryName> 
			<QueryName condition="end with">.microsoftstore.com</QueryName> 
			<QueryName condition="end with">.ms-acdc.office.com</QueryName> 
			<QueryName condition="end with">.msedge.net</QueryName> 
			<QueryName condition="end with">.msn.com</QueryName> 
			<QueryName condition="end with">.msocdn.com</QueryName> 
			<QueryName condition="end with">.skype.com</QueryName> 
			<QueryName condition="end with">.skype.net</QueryName> 
			<QueryName condition="end with">.windows.com</QueryName> 
			<QueryName condition="end with">.windows.net.nsatc.net</QueryName> 
			<QueryName condition="end with">.windowsupdate.com</QueryName> 
			<QueryName condition="end with">.xboxlive.com</QueryName> 
			<QueryName condition="is">login.windows.net</QueryName> 
			<Image condition="begin with">C:\ProgramData\Microsoft\Windows Defender\Platform\</Image> 
			<!--Microsoft:Office365/AzureAD-->
			<QueryName condition="end with">.activedirectory.windowsazure.com</QueryName> 
			<QueryName condition="end with">.aria.microsoft.com</QueryName> 
			<QueryName condition="end with">.msauth.net</QueryName>
			<QueryName condition="end with">.msftauth.net</QueryName>
			<QueryName condition="end with">.opinsights.azure.com</QueryName> 
			<QueryName condition="end with">osi.office.net</QueryName> 
			<QueryName condition="is">loki.delve.office.com</QueryName>
			<QueryName condition="is">management.azure.com</QueryName> 
			<QueryName condition="is">messaging.office.com</QueryName>
			<QueryName condition="is">outlook.office365.com</QueryName> 
			<QueryName condition="is">portal.azure.com</QueryName> 
			<QueryName condition="is">protection.outlook.com</QueryName> 
			<QueryName condition="is">substrate.office.com</QueryName> 
			<!--3rd-party applications-->
			<QueryName condition="end with">.mozaws.net</QueryName> 
			<QueryName condition="end with">.mozilla.com</QueryName> 
			<QueryName condition="end with">.mozilla.net</QueryName> 
			<QueryName condition="end with">.mozilla.org</QueryName> 
			<QueryName condition="is">clients1.google.com</QueryName> 
			<QueryName condition="is">clients2.google.com</QueryName> 
			<QueryName condition="is">clients3.google.com</QueryName> 
			<QueryName condition="is">clients4.google.com</QueryName> 
			<QueryName condition="is">clients5.google.com</QueryName> 
			<QueryName condition="is">clients6.google.com</QueryName> 
			<QueryName condition="is">safebrowsing.googleapis.com</QueryName> 
			<!--Goodlist CDN-->
			<QueryName condition="end with">.akadns.net</QueryName> 
			<QueryName condition="is">aspnetcdn.com</QueryName>
			<QueryName condition="end with">.aspnetcdn.com</QueryName> 
			<QueryName condition="is">ajax.googleapis.com</QueryName>
			<QueryName condition="is">cdnjs.cloudflare.com</QueryName> 
			<QueryName condition="is">fonts.googleapis.com</QueryName> 
			<QueryName condition="end with">.typekit.net</QueryName>
			<QueryName condition="is">cdnjs.cloudflare.com</QueryName>
			<!--Web resources-->
			<QueryName condition="end with">.disqus.com</QueryName> 
			<QueryName condition="end with">.fontawesome.com</QueryName>
			<QueryName condition="is">disqus.com</QueryName> 
			<!--Ads-->
			<QueryName condition="end with">.1rx.io</QueryName> 
			<QueryName condition="end with">.2mdn.net</QueryName> 
			<QueryName condition="end with">.adadvisor.net</QueryName>
			<QueryName condition="end with">.adap.tv</QueryName>
			<QueryName condition="end with">.addthis.com</QueryName> 
			<QueryName condition="end with">.adform.net</QueryName>
			<QueryName condition="end with">.adnxs.com</QueryName>
			<QueryName condition="end with">.adroll.com</QueryName>
			<QueryName condition="end with">.adrta.com</QueryName>
			<QueryName condition="end with">.adsafeprotected.com</QueryName>
			<QueryName condition="end with">.adsrvr.org</QueryName> 
			<QueryName condition="end with">.advertising.com</QueryName> 
			<QueryName condition="end with">.amazon-adsystem.com</QueryName> 
			<QueryName condition="end with">.amazon-adsystem.com</QueryName> 
			<QueryName condition="end with">.analytics.yahoo.com</QueryName> 
			<QueryName condition="end with">.aol.com</QueryName> 
			<QueryName condition="end with">.betrad.com</QueryName> 
			<QueryName condition="end with">.bidswitch.net</QueryName> 
			<QueryName condition="end with">.casalemedia.com</QueryName> 
			<QueryName condition="end with">.chartbeat.net</QueryName> 
			<QueryName condition="end with">.cnn.com</QueryName> 
			<QueryName condition="end with">.convertro.com</QueryName> 
			<QueryName condition="end with">.criteo.com</QueryName> 
			<QueryName condition="end with">.criteo.net</QueryName> 
			<QueryName condition="end with">.crwdcntrl.net</QueryName> 
			<QueryName condition="end with">.demdex.net</QueryName> 
			<QueryName condition="end with">.domdex.com</QueryName> 
			<QueryName condition="end with">.dotomi.com</QueryName> 
			<QueryName condition="end with">.doubleclick.net</QueryName>
			<QueryName condition="end with">.doubleverify.com</QueryName>
			<QueryName condition="end with">.emxdgt.com</QueryName> 
			<QueryName condition="end with">.exelator.com</QueryName> 
			<QueryName condition="end with">.google-analytics.com</QueryName> 
			<QueryName condition="end with">.googleadservices.com</QueryName>        
			<QueryName condition="end with">.googlesyndication.com</QueryName>
			<QueryName condition="end with">.googletagmanager.com</QueryName>         
			<QueryName condition="end with">.googlevideo.com</QueryName>
			<QueryName condition="end with">.gstatic.com</QueryName> 
			<QueryName condition="end with">.gvt1.com</QueryName>          
			<QueryName condition="end with">.gvt2.com</QueryName>           
			<QueryName condition="end with">.ib-ibi.com</QueryName>
			<QueryName condition="end with">.jivox.com</QueryName>  
			<QueryName condition="end with">.mathtag.com</QueryName> 
			<QueryName condition="end with">.moatads.com</QueryName> 
			<QueryName condition="end with">.moatpixel.com</QueryName> 
			<QueryName condition="end with">.mookie1.com</QueryName>   
			<QueryName condition="end with">.myvisualiq.net</QueryName>    
			<QueryName condition="end with">.netmng.com</QueryName>     
			<QueryName condition="end with">.nexac.com</QueryName> 
			<QueryName condition="end with">.openx.net</QueryName>      
			<QueryName condition="end with">.optimizely.com</QueryName>       
			<QueryName condition="end with">.outbrain.com</QueryName>        
			<QueryName condition="end with">.pardot.com</QueryName>         
			<QueryName condition="end with">.phx.gbl</QueryName> 
			<QueryName condition="end with">.pinterest.com</QueryName>
			<QueryName condition="end with">.pubmatic.com</QueryName> 
			<QueryName condition="end with">.quantcount.com</QueryName>
			<QueryName condition="end with">.quantserve.com</QueryName>
			<QueryName condition="end with">.revsci.net</QueryName> 
			<QueryName condition="end with">.rfihub.net</QueryName>
			<QueryName condition="end with">.rlcdn.com</QueryName> 
			<QueryName condition="end with">.rubiconproject.com</QueryName>
			<QueryName condition="end with">.scorecardresearch.com</QueryName> 
			<QueryName condition="end with">.serving-sys.com</QueryName> 
			<QueryName condition="end with">.sharethrough.com</QueryName>          
			<QueryName condition="end with">.simpli.fi</QueryName>
			<QueryName condition="end with">.sitescout.com</QueryName>  
			<QueryName condition="end with">.smartadserver.com</QueryName>   
			<QueryName condition="end with">.snapads.com</QueryName>    
			<QueryName condition="end with">.spotxchange.com</QueryName>     
			<QueryName condition="end with">.taboola.com</QueryName> 
			<QueryName condition="end with">.taboola.map.fastly.net</QueryName> 
			<QueryName condition="end with">.tapad.com</QueryName>
			<QueryName condition="end with">.tidaltv.com</QueryName> 
			<QueryName condition="end with">.trafficmanager.net</QueryName>
			<QueryName condition="end with">.tremorhub.com</QueryName> 
			<QueryName condition="end with">.tribalfusion.com</QueryName> 
			<QueryName condition="end with">.turn.com</QueryName> 
			<QueryName condition="end with">.twimg.com</QueryName> 
			<QueryName condition="end with">.tynt.com</QueryName> 
			<QueryName condition="end with">.w55c.net</QueryName> 
			<QueryName condition="end with">.ytimg.com</QueryName> 
			<QueryName condition="end with">.zorosrv.com</QueryName> 
			<QueryName condition="is">1rx.io</QueryName>
			<QueryName condition="is">adservice.google.com</QueryName> 
			<QueryName condition="is">ampcid.google.com</QueryName> 
			<QueryName condition="is">clientservices.googleapis.com</QueryName> 
			<QueryName condition="is">googleadapis.l.google.com</QueryName> 
			<QueryName condition="is">imasdk.googleapis.com</QueryName> 
			<QueryName condition="is">l.google.com</QueryName>
			<QueryName condition="is">ml314.com</QueryName>
			<QueryName condition="is">mtalk.google.com</QueryName> 
			<QueryName condition="is">update.googleapis.com</QueryName> 
			<QueryName condition="is">www.googletagservices.com</QueryName> 
			<!--OSCP/CRL Common-->
			<QueryName condition="end with">.digicert.com</QueryName>
			<QueryName condition="end with">.globalsign.com</QueryName>
			<QueryName condition="end with">.globalsign.net</QueryName>
			<QueryName condition="is">msocsp.com</QueryName> 
			<QueryName condition="is">ocsp.msocsp.com</QueryName> 
			<QueryName condition="is">pki.goog</QueryName>
			<QueryName condition="end with">.pki.goog</QueryName>
			<QueryName condition="is">ocsp.godaddy.com</QueryName>
			<QueryName condition="is">amazontrust.com</QueryName>
			<QueryName condition="end with">.amazontrust.com</QueryName>
			<QueryName condition="is">ocsp.sectigo.com</QueryName>
			<QueryName condition="is">pki-goog.l.google.com</QueryName>
			<QueryName condition="end with">.usertrust.com</QueryName>
			<QueryName condition="is">ocsp.comodoca.com</QueryName>
			<QueryName condition="is">ocsp.verisign.com</QueryName>
			<QueryName condition="is">ocsp.entrust.net</QueryName>
			<QueryName condition="is">ocsp.identrust.com</QueryName>
			<QueryName condition="end with">.ocsp.identrust.com</QueryName>
			<QueryName condition="is">status.rapidssl.com</QueryName>
			<QueryName condition="is">status.thawte.com</QueryName>
			<QueryName condition="is">ocsp.int-x3.letsencrypt.org</QueryName>
		</DnsQuery>
	</RuleGroup>

	<!--SYSMON EVENT ID 255 : ERROR-->
		<!--Cannot be filtered.-->
	</EventFiltering>
</Sysmon>
